# Optimization
Optimization algorithms are important to determine the best set of parameters or the best combination of signals for a [strategy](https://github.com/psemdel/py-trading-bot/blob/main/docs/strategies.md) for a given set of stocks. The optimization must moreover avoid overfitting.

The optimization scripts provided must be started by opt_starter.py (in the root). Several scripts are provided, but obviously they are only examples (no guarantee here!). The only thing that matters here is the resulting strategy, the optimization algorithm is just a mean.

In opt_main, the set will be split in a learning and a test set. By comparing the results on both set, you can verify how reliable is your strategy. By default this split is made on the time (`split_learn_train=time`). You can also split on the symbols (`split_learn_train=symbol`).

Most of the algorithm will make evolve the strategy array until it cannot be improved anymore. The starting array can be defined by setting `strat_arr=` a strategy array. If no starting array is defined, a random one will be generated, the consideration of the trend depends on the `nb_macro_modes`, if you don't want to consider the trend put 1 otherwise 3. The process is performed several time in a row. The number of iterations is defined by the parameter `loops`. To be sure that your optimization met one of the best possible combination, it is recommended to perform many loops (it is a typical local extremum vs global extremum issue). 

Please note that by default the fees during the optimization are not zero. Keep it in mind, when reviewing your results.

Results are written in opt/output/strat.txt. Additionally, a dataframe is created in opt/tested_arrs/. It gathers all calculate combination and allows an easy postprocessing to select the strategy that fit your need. The jupyter notebook tested_arrs_reader.ipynb is a starting point for this selection.

## opt_strat
Opt_strat aims at optimizing a strategy for one stock on a given set of stocks.

## opt_sl
Try to find out the best stop loss threshold for a given strategy.

## opt_macro
Optimize the parameters for the trend calculation in order to have maximum return during the bull trend and minimum return during the bear trend.

## Correlation
To display correlation between symbol prices, you can use the jupyter notebook corr.ipynb. You can then perform filtering for some symbols with pandas from the dataframe generated by opt_strat.
